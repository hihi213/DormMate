# 개발 환경 설정

# 팀 공용 개발 환경 설정을 담당하는 파일
# 환경변수 이용 시 생성하는 .env 파일은 관리자에 따라 배포되지 않을 수 있음.   
 
# PostgreSQL Datasource (개발용)
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/dormitory_db}
spring.datasource.username=${DB_USERNAME:dorm_user}
spring.datasource.password=${DB_PASSWORD:dorm_password}
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# PostgreSQL 16 최적화 설정
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# Redis (개발용)
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.timeout=2000ms

# Flyway Database Migration (개발용)
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.validate-on-migrate=true

# JWT Configuration (개발용)
# 기본값은 Base64 인코딩된 32바이트 이상 문자열이어야 함
jwt.secret=${JWT_SECRET:VGhpcy1pcy1kZXZlbG9wLWp3dC1zZWNyZXQtc2VlZCE=}
jwt.expiration=${JWT_EXPIRATION:86400000}
jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}

# SpringDoc OpenAPI 설정 (개발용 - Swagger UI 활성화)
springdoc.api-docs.enabled=true
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html

# AWS S3 Configuration (개발용 - 로컬 파일 시스템 사용)
aws.s3.bucket=${AWS_S3_BUCKET:dormmate-dev-storage}
aws.s3.region=${AWS_S3_REGION:ap-northeast-2}
aws.s3.access-key=${AWS_ACCESS_KEY:dev-access-key}
aws.s3.secret-key=${AWS_SECRET_KEY:dev-secret-key}

# Spring Security (개발용)
spring.security.user.name=${SPRING_SECURITY_USER:admin}
spring.security.user.password=${SPRING_SECURITY_PASS:admin}

# Actuator & Monitoring (개발용 - 모든 엔드포인트 노출)
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always
management.metrics.export.prometheus.enabled=true

# WebSocket
spring.websocket.max-text-message-size=8192
spring.websocket.max-binary-message-size=8192

# File Upload (개발용 - 큰 파일 허용)
spring.servlet.multipart.max-file-size=50MB
spring.servlet.multipart.max-request-size=50MB

# Logging (개발용 - 상세 로깅)
logging.level.com.dormmate=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.flywaydb=INFO

# PostgreSQL 16 업그레이드 완료 로그
logging.level.org.postgresql=INFO

# Server
server.port=${SERVER_PORT:8080}
server.servlet.context-path=/

# CORS 허용 오리진 (쉼표 구분)
app.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:5173,http://localhost:3000}

# 개발 환경 특화 설정
spring.jpa.defer-datasource-initialization=false
spring.sql.init.mode=never

# (application.properties의 설정을 상속받아 사용)

# 헬스체크 시 DB 연결 상태 등 상세 정보를 항상 표시하여 디버깅에 용이하게 함
management.endpoint.health.show-details=always

# [선택] 개발 편의를 위해 info, beans 등 다른 유용한 엔드포인트를 추가로 노출할 수 있습니다.
management.endpoints.web.exposure.include=health,info,beans,mappings
