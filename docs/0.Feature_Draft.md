# 1. 프로젝트 개요 및 현황

DormMate 프로젝트는 기숙사 냉장고 관리 시스템으로, 기숙사생의 물품 등록, 유통기한 관리, 층별장 검사, 알림 기능을 통해 냉장고 위생과 효율성을 높이는 것을 목표로 합니다. 이 프로젝트는 사용자의 첫 번째 솔로 개발 경험으로, Spring Boot 백엔드 중심의 MVP(Minimum Viable Product)를 24일 내 구현하며, 프론트엔드는 AI 도움을 받아 최소화합니다. 전체적으로 현실적인 기숙사 운영 문제를 해결하면서, 백엔드 개발자 포트폴리오로 활용할 수 있도록 설계되었습니다.

## 현실 기숙사 및 내 상황 요약

### 기숙사 운영 현황

**층 구성 및 성별 배치**

기숙사는 2층부터 5층까지 숙소로 운영되며, 2층은 남성 전용, 3~5층은 여성 전용입니다. 각 층에는 24개의 호실(예: 201~224, 301~324)이 배치되어 있으며, 1인실, 3인실 두가지 종류로 나뉘어집니다

**호실 유형 및 1인실 위치**
- **3인실 (TRIPLE)**: 22개 호실, capacity=3, personal_no 1~3
- **층별 1인실 위치**: capacity=1, personal_no=1 고정
  - 2층: 213호, 224호
  - 3층: 313호
  - 4층: 413호
  - 5층: 513호

거주자는 호실 번호와 개인 번호로 식별되며, 예를 들어 "201-1"과 같이 구분합니다. 거주 기간은 최대 1년으로, 중도 퇴사가 가능합니다.

**냉장고 구조 및 호실 배분**

각 거주층에는 냉장고 1대가 배치되어 있으며(총 4대, 2~5층), 현재의 냉장고는 냉장 칸 3개와 냉동 칸 1개로 구성됩니다(총 4칸). 다음 추가할 냉장고의 냉장/냉동칸 개수는 예측할 수 없습니다.

**호실 배분 규칙**: 층당 냉장칸/냉동칸에 24개 호실을 균등 배분
- 냉장칸 3개의 경우: 24/3=8, 8호실 균등배분
- 냉동칸 1개의 경우: 24/1=24, 24호실 공용
- slot 1 (냉장 1번 칸): 01~08호
- slot 2 (냉장 2번 칸): 09~16호
- slot 3 (냉장 3번 칸): 17~24호
- slot 4 (냉동 칸): 전체 24호실 공용 (24/1=24)
- 층당 2대로 증설시
	- 1호 냉장고: slot 1~4 (기존)
	- 2호 냉장고: slot 5~8 (신규)
	- 호실 재배분: 냉장 6칸 → 4호실/칸
	- compartment_room_access 자동 재계산

**층별장 및 검사**

층별로 기숙사생 중 일부를 '층별장'으로 임명하여 냉장고 관리, 정기 검사, 벌점 부여 등의 역할을 맡깁니다. 층별장은 1명혹은 최대 2명 임명되며, 동일칸 검사시 최대 2명이 동일 검사 세션을 공유하여 함께 검사를 진행합니다

**기타 시설 및 소통**

세탁실은 별도 건물에 남성용(세탁기 6대 + 건조기 2대)과 여성용(세탁기 7대 + 건조기 6대)으로 나뉘어 있으며, 남성 세탁실의 이불 건조기 2대는 남녀 공용이라 모두가 사용가능합니다. 3개의 다목적실과 도서관은 모든 기숙사생이 자유롭게 이용 가능합니다. 현재 소통은 Band 앱을 통해 이뤄지며, 공지사항은 게시물 형태로 전달되고, 냉장고 점검 결과(위반 목록)도 게시물로 공유됩니다. 이로 인해 신규 알림 시스템이 Band와 중복되지 않도록 설계해야 하며, 기숙사생의 알림 피로를 고려해 백그라운드 알림 설정 기능을 포함합니다.

### 개발자(사용자) 상황

사용자는 컴퓨터 공학 전공 대학생으로, Java 기초는 익혔으나 Spring Boot는 기본 수준만 학습한 상태입니다. 중견 기업 이상의 백엔드 개발자 지망생으로, 이 프로젝트가 첫 번째 솔로 개발 프로젝트입니다. 혼자서 진행하며,  MVP를 완성해야 하는 제약 조건 하에 있습니다. 프론트엔드(React) 부분은 AI 도구를 최대한 활용하여 80% 이상 생성할 계획으로, 백엔드(Spring Boot, JPA, Security) 학습과 구현에 집중합니다. 개발 환경은 M1 MacBook을 기반으로 하며, AI 어시스턴트(예: ChatGPT, Perplexity)를 통해 코드 생성과 디버깅을 지원받습니다.

# DormMate 프로젝트 전체 기능 설명

## Phase 1: 냉장고 관리 시스템 

## 🏠 일반 기숙사생 관점

### 회원가입 및 계정 관리

- 호실 번호(201, 313 등)와 개인 번호(1~3)로 가입
- 1인실은 개인 번호 1 고정, 3인실은 1~3 중 부여받음
- 아이디(대소문자 무시) 로그인 후 7일간 유효한 세션 유지
- 이메일은 비밀번호 변경용으로만 사용
- 비밀번호 변경 시 자동 로그아웃 후 재로그인
- 탈퇴 시 계정 비활성화, 물품 이력은 보존

### 냉장고 물품 등록 (장바구니 방식)

**핵심 개념**
- **포장 (FridgeBundle)**: 스티커 1개를 부착하는 물리적 단위
- **물품 (FridgeItem)**: 포장 안에 들어있는 개별 품목
- 포장 1개 = 스티커 1개 = 물품 N개

**칸 선택**
- 배정된 칸만 선택 가능 (일반적으로 냉장칸 1개, 냉동칸 1개)
- 등록 시 냉장/냉동 선택만으로 간편 등록
- 칸이 가득 찬 경우 오류 메시지 표시

### 내 물품 조회 및 관리

**기본 조회**

- 등록된 모든 포장을 최신순으로 표시
- 각 포장에 스티커 코드, 품목 목록, 유통기한 표시
- 유통기한 D-3 이하는 빨간색으로 강조
- 등록 일시, 칸 위치 정보 표시

**필터링 및 검색**
- **임박** 필터: 유통기한 3일 이내 (노란색 배지)
- **만료** 필터: 유통기한 지남 (빨간색 배지, 폐기 권장)
- 품목명 또는 포장명 검색 (예: "계란", "아침")
- 칸선택후 스티커 코드 정확 검색 (예: A-003이면, 003")
- 검색 결과 없을 시 "등록된 물품이 없습니다" 빈 목록

**포장 정보 수정**
- [수정] 버튼 클릭
- 수정 가능: 포장명, 메모
- 수정 불가: 스티커 코드, 등록 일시
**포장 내 물품 수정**
- 포장 상세 화면 진입
- 개별 물품 수정:
  - 물품명, 유통기한 변경 가능
  - 검사후 수정인경우 다음 검사 시 "검사 후 수정됨" 필터에 표시됨

**포장 전체 삭제**
**물품 개별 삭제**
- 포장 상세 화면에서 특정 물품 [삭제] 버튼
- 확인 다이얼로그: "정말 삭제하시겠습니까?"
- 확인 시 해당 물품만 소프트 삭제 
- 포장의 다른 물품은 유지됨**

**접근 제어**
- 본인이 등록한 포장/물품만 수정/삭제 가능
- 메모는 등록한 본인만이 볼수있다
- 다른 사용자 물품 수정 시도 시 403 Forbidden 에러
- 검사 중인 칸의 물품은 수정 불가 (잠금 표시)
- 삭제된 물품의 라벨 번호는 자동으로 재사용 가능 상태로 전환
- 검사 진행 중인 칸의 물품은 수정 불가
### 알림 시스템

**유통기한 임박 알림**

- 매일 오전 9시 자동 검사
- 유통기한 3일 이내 물품 알림 발송
- "계란 외 2개 물품의 유통기한이 3일 남았습니다" 형식
- 하루 1회 제한으로 중복 알림 방지

**검사 결과 알림**
- 층별장이 검사 제출 시 즉시 발송
- 경고 또는 폐기 조치받은 사용자에게만 발송
- 알림 클릭 시 검사결과 페이지로 이동

**알림 관리**

- 미읽음 알림 상단 배치, 읽음 알림 하단 배치
- 냉장고 메인 화면 진입 시 관련 알림 자동 읽음 처리
- 읽은 알림은 회색 처리, 24시간 후 자동 만료
- 만료된 알림은 목록에서 자동 제거
- 알림 설정에서 종류별 켜기/끄기 가능
- 백그라운드 알림 설정 지원 (Band앱 기능과 중복 방지)

### 프로필

- 이름, 이메일, 호실, 개인 번호, 역할 확인

---

## 🔍 층별장(검사자) 관점

### 권한 및 임명

- 관리자가 일반 기숙사생을 층별장으로 임명
- 임명 즉시 검사 권한 활성화
- 층당 최대 2명까지 임명 가능
- 해제 시 일반 기숙사생 역할로 복귀
- 진행 중인 검사는 강제 종료, 과거 이력은 보존

### 검사 세션 시작

**검사 준비**

- 자신이 속한 층의 칸만 검사 가능
- 검사할 칸 선택 후 "검사 시작" 버튼 클릭
- 세션 생성 시 해당 칸의 물품 수정 자동 잠금
- 일반 사용자는 검사 완료까지 물품 수정 불가

**공동 검사**

- 동일 칸에 이미 검사 진행 중이면 "검사 합류" 버튼으로 변경
- 최대 2명이 동일 세션에서 협업 가능
- 두 검사자의 화면이 실시간으로 동기화
- 한 칸에는 동시에 하나의 검사만 진행

### 물품 검사 및 조치

**검사 화면 구성**

**상단 헤더**
- 제목: "냉장고 검사"
- 검사 중인 칸 정보 표시
- 검사자 정보 (본인 + 공동 검사자) 우측에 작게 표시

**탭 구조**
- **"검사 전" 탭**: 조치되지 않은 포장 목록
- **"검사 완료" 탭**: 조치된 포장 목록
  - 본인 조치: 검정 테두리 표시
  - 상대방 조치: 테두리 표시 없음

**필터 버튼**
- **"만료" 필터**: 유통기한 지난 물품 포함 포장만 표시
- **"검사 후 수정됨" 필터**: 마지막 검사 후 변경된 포장만 표시

**검색바**
- 포장명 또는 물품명으로 검색 가능
**경고 조치 처리

- 물품 카드에서 "조치" 버튼 클릭
- 경고 사유 선택:
	- 정보 불일치: 스티커 정보와 실제 물품 다른경우
	- 보관 불량
- 해당 물품이 "검사 완료" 탭으로 이동
- SSE로 다른 검사자에게 실시간 전파
- 상대방 화면에서도 "검사 완료" 탭에 표시 (조치자 이름 표시)

폐기 조치 처리

- 유통기한 지난 목록의경우 조치버튼대신 폐기버튼 활성화
- 폐기 확인 다이얼로그: "정말 폐기하시겠습니까?"
- 확인 시 조치 완료, "검사 완료" 탭으로 이동
- 실시간 동기화

미등록 물품 즉시 등록 후 폐기

- 냉장고에서 시스템에 없는 물품 발견 시
- "미등록 물품 추가" 버튼 클릭
- 품목이름 간단입력후 검사완료탭에 미등록 폐기물품으로 등록

문제없음 처리

- 물품에 이상 없을 시 "통과" 버튼 클릭
- 조치 없이 "검사 완료" 탭으로 이동
- 통계에는 미포함 (정상 물품)

### 실시간 협업
**동시 검사 시나리오**
- 검사자 A가 포장 1의 물품1에 "경고" 조치
- 서버에서 InspectionSession 업데이트
- SSE로 검사자 B에게 이벤트 전송
- 검사자 B 화면에서 포장 1의 물품1 이 "검사 전" → "검사 완료"로 자동 이동 (포장안의 다른 물품들은 아직 검사전 탭)
- UI에 "검사자 A가 조치함" 표시 (검정 테두리)
- 검사자 B는 포장 2를 동시에 검사 가능

**네트워크 끊김 시 재연결**
- EventSource 자동 reconnection
- 재연결 시 서버에서 현재 세션 상태 전송
- 누락된 조치 내역 자동 동기화
- 검사 중단 없이 계속 진행 가능
### 검사 결과 제출

**최종 제출 조건**
- 모든 포장이 "검사 완료" 탭에 있을 때 활성화
- "검사 전" 탭이 비어 있어야 함
- 두 검사자 중 누구나 제출 가능

**제출 프로세스**
- [최종 제출] 버튼 클릭
- 확인 다이얼로그: "검사를 종료하고 결과를 제출하시겠습니까?"
- 확인 시 서버로 검사 결과 일괄 전송
- DB에 검사 이력 저장:
  - 검사자 ID(들)
  - 검사 일시
  - 칸 ID
  - 각 포장별 조치 내역 (사유, 메모)
- 통계 자동 집계:
  - 경고 건수
  - 폐기 건수
  - 검사 포장 총 수
  - 호실별 조치 건수
- 조치받은 사용자에게 알림 자동 발송
- 검사 세션 종료, 칸 잠금 해제
- 일반 사용자 물품 수정 가능 상태로 복귀

**검사 취소**
- 검사 중 [취소] 버튼 클릭
- 확인 다이얼로그: "진행 중인 검사를 취소하시겠습니까? (저장되지 않습니다)"
- 확인 시 세션 삭제, 메모리 데이터 폐기
- DB 미반영, 알림 미발송
- 칸 잠금 즉시 해제

### 검사 이력 조회

- 자신의 층에 대한 검사 이력만 표시
- 과거 검사 목록 표시 (최신순)
- 각 검사 카드:
  - 검사 일시
  - 칸 정보
  - 공동 검사자 (있을 경우)
  - 통계: 경고 N건, 폐기 M건
- 카드 클릭 시 상세 내역:
  - 조치된 포장 목록(검사완료의 탭을 재활용해도 좋을듯)
  - 호실, 포장명, 사유
  - 조치별 필터링 가능


## 👨‍💼 관리자 관점

### 대시보드 및 현황

**전체 통계 조회**

- 전체 등록 물품 수 (층별, 칸별)
- 유통기한 임박 물품 수 (전체 기숙사)
- 이번 주 검사 횟수 및 조치 건수
- 활성 사용자 수 (거주자, 층별장 구분)
- 최근 검사 이력 목록 (전체 층)
- 알림 발송 현황 (성공/실패)

### 층별장 임명 및 해제**
- 역할 변경 즉시 반영
- 현재 층별장 목록 조회
- 권한 해제 시 역할 복귀 및 진행 중 검사 강제 종료

### 전체 물품 관리

**조회 및 필터링**

- 전체 기숙사 물품 목록 조회
- 층별(2~5층), 칸별, 호실별 필터
- 상태별 필터 (정상, 임박, 만료)
- 품목명, 스티커 코드, 호실 번호로 검색
- 50개씩 페이지네이션

**강제 수정 및 삭제** (추후 도입)

- 특정 물품 선택 후 수정 또는 삭제
- 유통기한, 품목명 등 변경 가능
- 삭제 시 사유 메모 입력 (예: "휴관 모드로 인한 일괄 삭제")
- 해당 사용자에게 알림 자동 발송

**일괄 처리**

- 여러 물품 체크박스 선택
- 일괄 삭제, 상태 일괄 변경
- 확인 다이얼로그로 안전장치

### 검사 이력 전체 조회

**전체 이력 관리**

- 전체 층의 검사 이력 조회
- 층별, 검사자별, 기간별 필터
- 각 검사의 상세 조회 (일시, 검사자, 칸, 통계)
- 조치된 물품 목록 확인

**통계 및 리포트**

- 월별/주별 검사 통계 그래프
- 호실별 조치 건수 순위 (위생 관리 지표)
- CSV 내보내기 기능 (엑셀 분석)

### 사용자 관리

**사용자 조회 및 관리**

- 전체 기숙사생 목록 (호실, 이름, 이메일, 역할)
- 층별, 역할별, 호실별
- 이름, 호실 번호로 검색
- 특정 사용자 선택 후 역할 변경
- 거주자 ↔ 층별장 ↔ 관리자 전환 가능
- 변경 시 권한 즉시 반영

**계정 비활성화**

- 퇴사자 또는 문제 사용자 계정 비활성화
- 비활성화 시 로그인 차단
- 등록된 물품 및 검사 이력은 보존

### 시스템 설정

**알림 배치 관리**

- 유통기한 알림 발송 시각 설정 (기본 09:00)
- 배치 스케줄 활성화/비활성화
- 테스트 알림 발송 기능

**냉장고 자원 관리**

- 층별 냉장고 유닛 조회
- 칸 구조 확인 (각 칸의 라벨 범위)
- 호실별 칸 배분 현황 확인
- 냉장고 추가 시 자동 호실 재배분
- 냉장고 삭제 기능

**시스템 모니터링**

- 서버 상태 확인 (CPU, 메모리, 디스크)
- API 응답 시간 통계
- 에러 로그 조회 (최근 100건)

---

## Phase 2: 확장 모듈 (세탁실, 도서관, 다목적실)

## 🧺 세탁실 관리

## 일반 사용자 기능

**세탁실 현황 조회**

- 대시보드에 바로 사용 가능한 기기 표시
- 사용 중인 기기의 진행바 및 남은 시간 표시
- 기기별 상태 (사용 가능, 사용 중, 완료, 고장)
- 기기 카드에 기기명, 상태, 종료 예정 시간 표시

**기기 사용 등록**

- 사용 가능한 기기 선택
- 기본 시간 표시 (세탁기 38분, 건조기 50분)
- 1분/10분 단위로 시간 증감
- 개인 프리셋 저장 (자주 쓰는 시간)
- "사용 등록" 버튼으로 사용 시작

**건조기 특별 기능**

- 이전 사용자에게 필터 청소 요청 알림 발송 옵션
- 건조 효율 향상을 위한 협조 요청

**타인 사용 중 기기**

- 종료 5분 전 알림 신청 가능
- 남은 시간 정정 (±10분 범위, 원사용자에게 알림)
- 메시지 전송 ("기다리고 있어요", "세탁물 빼놨어요")
- 메시지 읽음 여부 표시

**본인 사용 중 기기**

- 남은 시간 정정 (알림 없음)
- 종료 알림 설정 확인
- 사용 취소 가능

**완료 후 미수거 기기**

- 완료 후 5분 경과 시 "기다리고 있어요" 알림 발송 가능 (1회)
- "세탁물 빼놨어요" 버튼으로 강제 사용 가능 상태 전환
- 다음 사용자 편의 제공

**미등록 사용 처리**

- 시스템 등록 없이 사용 중인 기기 발견 시
- "미등록 사용 등록" 버튼으로 간편 등록
- 남은 작동 시간 입력
- 종료 알림 기본 비활성화
- 시간 경과 시 자동 사용 가능 상태 전환

**고장 신고**

- 누구나 고장 신고 가능
- 신고 사유 입력 (선택)
- 신고 접수 시 사용 차단
- 관리자 확인 후 정식 고장 상태 전환
- 신고자에게 처리 결과 알림

**알림 수신**

- 종료 5분 전: "[세탁실] {기기명} 종료 임박 - 약 5분 뒤 종료"
- 종료 완료: "[세탁실] {기기명} 종료 - 지금 수거 필요"
- 메시지 도착: "[세탁실] {기기명} 메시지 도착 - 다른 사용자 요청"
- 시간 수정: "[세탁실] {기기명} 시간 갱신 - 시간 조정 알림"
- 상태 변경: "[세탁실] {기기명} 상태 변경 - 관리자 조치"

## 관리자 기능

- 기기 상태 수동 변경 (강제 사용 가능, 고장 상태)
- 고장 신고 접수 및 처리
- 사용 통계 조회 (기기별 이용률, 피크 시간대)
- 기기별 평균 사용 시간 분석

---

## 📚 도서관 관리

## 일반 사용자 기능

**도서 검색**
- 제목, 저자, 도서번호로 검색
- 인기 탭: 최근 N주 대출 수 순위
- 신규 탭: 등록일 최신순
- 검색 결과에 대출 상태 표시
- 도서 목록 클릭: **원스톱 팝업**에서 대출/반납/연장/예약
- **알림/벌점**: 반납일 **5일 전 알림**, 연체 시 **자동 벌점**
- **경량화**: **예약 대기열은 1명만** 허용

**도서 대출 (대출 가능 상태)**
- "대출하기" 버튼 클릭으로 즉시 대출
- 대출 기간 기본 14일
- 대출 시작일: 오늘
- 반납 예정일: 14일 후 자동 계산

**본인 대출 중인 도서**

- "반납하기" 버튼으로 반납 처리
- "연장하기" 버튼 (1회 한정, +7일)
- 현재 대출 정보 표시 (대출일, 반납 예정일, 남은 일수)
- 연장 여부 표시

**타인 대출 중인 도서**

- "예약하기" 버튼 활성화
- 예약 대기열 최대 1명 (공정성 확보)
- 이미 예약자 있으면 "예약 불가" 표시

**예약 중인 도서 (본인)**

- "예약 취소" 버튼
- 현재 대출자 반납 예정일 표시
- 예약 유효 기간: 반납일 + 5일
- 5일 내 미대출 시 예약 자동 취소

**알림 수신**

- 반납 5일 전(09:00): "[도서관] 반납임박 - {권수}권 반납 또는 연장 필요"
- 반납 당일(09:00): "[도서관] 반납당일 - {권수}권 오늘 반납 필요"
- 연체(매일 09:00): "[도서관] 연체알림 - 즉시 반납 필요" + 자동 벌점 부과 (1일 1점)
- 예약 도서 대출 가능(즉시): "[도서관] 예약도서 대출 가능 - 5일간 대출 가능"
- 예약 만료 임박(+4일, 09:00): "[도서관] 예약만료 임박 - 오늘까지 대출 가능"

**내 대출 현황**

- 현재 대출 중인 도서 목록
- 과거 대출 이력
- 예약 중인 도서
- 연체 도서 (빨간색 강조)

**도서 반납**

- 반납 버튼 클릭 후 확인
- 반납 완료 시 예약자에게 자동 알림

## 관리자 기능

**도서 일괄 등록**
- 도서명, 저자, ISBN, 출판사, 출판년도 입력
- 엑셀 업로드 기능
- 분류 선택 (IT, 소설, 자기계발 등)
- 도서번호 자동 발급

**도서 수정 및 관리**

- 도서 정보 수정
- 분실 처리 (상태 LOST, 대출자 벌점)
- 삭제 (폐기 도서)

**대출 현황 관리**

- 전체 대출 현황 조회
- 연체 도서 목록 및 벌점 현황
- 강제 반납 처리
- 대출 통계 (인기 도서, 대출 빈도)

---

## 🏢 다목적실 예약

## 일반 사용자 기능

**타임라인 조회**

- 주간 캘린더 (오늘 ~ 다음 주 일요일)
- 시간대별 예약 현황 (10분 단위)
- 예약 가능: 초록색
- 예약 완료: 회색 (예약자 이름 공개)
- 합석 가능: 파란색 + 합석 뱃지

**예약 프로세스**

- 원하는 날짜 + 시간대 클릭
- 시작 시간, 종료 시간 선택 (10분 단위)
- 최소 30분, 최대 3시간
- "합석 허용" 체크박스 (다른 사용자에게 파란색 표시)
- 예약 정보 확인 (날짜, 시간, 방 번호)
- "예약하기" 버튼으로 확정

**내 예약 관리**

- 다가오는 예약 목록
- 과거 예약 이력
- 예약 취소 (시작 1시간 전까지 가능)
- 1시간 이내 취소 시 벌점 부과 (1점)

**알림 수신**

- 시작 10분 전: "[다목적실] {방번호}번 시작 임박 - 준비 필요"
- 종료 10분 전: "[다목적실] {방번호}번 종료 임박 - 정리 후 퇴실 준비"
- 관리자 취소: "[다목적실] {방번호}번 예약취소 - 관리자 조치"
- 노쇼 신고 접수: "[다목적실] {방번호}번 노쇼 신고 - 신고 접수됨"

**노쇼/미등록 신고**

- 예약했으나 사용하지 않음: 원클릭 노쇼 신고
- 예약 없이 사용 중: 원클릭 미등록 신고
- 신고 접수 시 관리 큐 적재
- 신고받은 사용자에게 알림
- 관리자 확인 후 벌점 수동 부여

## 관리자 기능

**강제 예약**

- 날짜 제한 없음 (유지보수, 행사 등)
- 일반 사용자 다이얼로그 재사용
- 일반 예약 차단 (해당 시간대)

**신고 관리**

- 노쇼/미등록 신고 큐 조회
- 신고 확인 및 벌점 부여
- 신고 기각 (오신고)

**예약 강제 취소**

- 사유 입력 필수
- 해당 사용자에게 알림 발송

---

## 공통 시스템 기능

## 🔔 알림 피로 방지

- 하루 최대 알림 수 제한 (모듈별 2건)
- Band 앱과 중복 제거 (임명, 공지 제외)
- 백그라운드 알림 설정 옵션 제공
- 알림 종류별 켜기/끄기 가능

## ⚖️ 상벌점 시스템

**자동 벌점**

- 도서관 연체: 1일 1점
- 다목적실 노쇼: 확인 후 2점
- 세탁실 방치: 확인 후 1점

**벌점 조회 및 제재**

- 사용자별 벌점 누적 조회
- 10점 이상 시 1주일 이용 정지 (자동)
- 벌점 이력 확인 가능

## 📊 감사 로그

- 모든 예약/대출/사용 기록 저장
- 관리자 조회 가능
- 분쟁 발생 시 증빙 자료
- 사용자 행동 패턴 분석

## 🔐 접근 제어

- 역할별 권한 분리 (일반/층별장/관리자)
- 본인 데이터만 수정/삭제 가능
- 검사 중 물품 수정 자동 차단
- 관리자 강제 조치 기록

## 📱 반응형 지원

- 모바일 우선 설계
- 터치 인터페이스 최적화
- 가로 스크롤 없이 세로 스크롤만 사용
- 태블릿/데스크톱 자동 레이아웃 조정


# DormMate Phase 2 시나리오 정리 (세탁실, 도서관, 다목적실)

## 세탁실 관리 시나리오

### 기본 구조
- 남성용: 세탁기 6대 + 건조기 2대
- 여성용: 세탁기 7대 + 건조기 6대  
- 남녀 공용: 이불 건조기 2대 (남성 세탁실 위치)

### 사용자 흐름

**1. 세탁실 메인 페이지 진입**
- 대시보드 상단: 바로 사용 가능한 기기 (AVAILABLE 상태)
- 사용 중인 기기: 진행바 + 남은 시간 표시
- 기기 카드: 기기명, 상태, 종료 예정 시간

**2. 기기 선택 및 상태별 팝업**

**AVAILABLE 상태 (사용 등록)**
- 기본 시간 표시 (세탁기 38분 / 건조기 50분)
- 1분/10분 단위 증감 버튼
- 개인 프리셋 저장 기능 (자주 쓰는 시간)
- 이전 사용자에게 필터 청소 요청 알림보내기 (건조기만)
- "사용 등록" 버튼 클릭 → 상태 IN_USE 전환

**IN_USE 상태 - 타인 사용 중**
- 종료 알림 신청 (5분 전 푸시 알림)
- 남은 시간 정정 (±10분 범위, 원사용자에게 알림)
- 메시지 전송 (예: "기다리고 있어요", "세탁물 빼놨어요")
- 메시지 읽음 여부 표시

**IN_USE 상태 - 본인 사용 중**
- 남은 시간 정정 (알림 없음)
- 종료 알림 설정 확인 (설정 페이지로 이동 유도)
- 사용 취소 버튼

**DONE 상태 (완료 후 5분 경과)**
- "기다리고 있어요" 버튼 (1회성 알림)
- "세탁물 빼놨어요" 버튼 (강제 AVAILABLE 전환)

**3. 미등록 사용 처리**
- 시스템에 등록 없이 사용 중인 기기 발견 시(시스템에서는 AVAILABLE)
- "미등록 사용 등록" 버튼 클릭
- 남은 작동시간 입력
- 종료 알림 기본 비활성화
- 설정 시간 경과 시 자동 AVAILABLE 전환

**4. 고장 신고**
- 누구나 신고 가능
- 신고 사유 입력 (선택)
- 상태: ERROR_REPORTED (사용 차단)
- 관리자 확인 후 OUT_OF_SERVICE 전환
- 신고자에게 처리 결과 알림

**5. 알림 수신**
- 종료 5분 전: "[세탁실] {기기명} 종료 임박 - 약 5분 뒤 사용이 종료되니 수거를 준비해주세요."
- 종료 완료: "[세탁실] {기기명} 종료 - 사용이 종료되었으니 지금 수거해주세요."
- 메시지 도착: "[세탁실] {기기명} 메시지 도착 - 다른 사용자 요청: {요청 이름}"
- 시간 수정: "[세탁실] {기기명} 시간 갱신 - 다른 사용자가 종료시간 오차 조정"
- 관리자 수동 상태 변경: "[세탁실] {기기명} 상태 변경 - {상태}로 전환"

### 관리자 기능
- 기기 상태 수동 변경 (강제 AVAILABLE, OUT_OF_SERVICE)
- 고장 신고 접수 및 처리
- 사용 통계 조회 (기기별 이용률, 피크 시간대)

***

## 도서관 관리 시나리오

### 사용자 흐름

**1. 도서 검색**
- 검색 옵션: 제목, 저자, 도서번호
- 인기 탭: 최근 N주 대출수 순 정렬
- 신규 탭: 등록일 최신순

**2. 원스톱 팝업 (도서 카드 클릭)**

**대출 가능 상태**
- "대출하기" 버튼 (즉시 대출, 기본 14일)
- 대출 시작일: 오늘
- 반납 예정일: 14일 후 표시

**대출 중 - 본인**
- "반납하기" 버튼
- "연장하기" 버튼 (1회 한정, +7일)
- 현재 대출 정보 (대출일, 반납 예정일, 남은 일수)

**대출 중 - 타인**
- "예약하기" 버튼
- 예약 대기열: 최대 1명 (공정성 확보)
- 이미 예약자 있으면 "예약 불가" 표시

**예약 중 - 본인**
- "예약 취소" 버튼
- 현재 대출자 반납 예정일 표시
- 예약 유효 기간: 반납일 + 5일

**3. 알림 수신**

**반납 임박 알림 (5일 전, 09:00)**
- "[도서관] 반납임박 알림 - {권수}권의 반납 또는 연장을 진행해주세요."
- 해당 도서 목록 링크

**반납 당일 알림 (09:00)**
- "[도서관] 반납당일 알림 - {권수}권의 반납을 오늘 완료해주세요."

**연체 알림 (매일 09:00, 영속)**
- "[도서관] 연체알림 - 대출 도서가 연체되었습니다. 즉시 반납해주세요."
- 자동 벌점 부과 (1일 1점)

**예약 도서 대출 가능 (즉시)**
- "[도서관] 예약도서 대출 가능 - {권수}권의 대출이 5일동안 가능해졌습니다."
- 5일 내 미대출 시 예약 자동 취소

**예약 만료 만료 (대출 가능일 +4일, 09:00)**
- "[도서관] 예약만료 임박 - {권수}권을 오늘까지 대출할 수 있습니다."

**4. 내 대출 현황**
- 현재 대출 중인 도서 목록
- 과거 대출 이력
- 예약 중인 도서
- 연체 도서 (빨간색 강조)

**5. 도서 반납**
- 반납 버튼 클릭
- 확인 다이얼로그
- 반납 완료 시 예약자에게 자동 알림

### 관리자 기능

**도서 일괄등록**
- 도서명, 저자, ISBN, 출판사, 출판년도 입력/엑셀 업로드
- 분류 선택 (IT, 소설, 자기계발 등)
- 도서번호 자동 발급

**도서 수정**
- 도서 정보 수정
- 분실 처리 (상태 LOST, 대출자에게 벌점)
- 삭제 (폐기 도서)

**대출 현황 관리**
- 전체 대출 현황 조회
- 연체 도서 목록 및 벌점 현황
- 강제 반납 처리

***

## 다목적실 예약 시나리오

### 기본 정책
- 10분 단위 예약 (예: 14:00, 14:10, 14:20)
- 매주 월요일 00:00 KST에 주간 오픈 (공정성)
- 합석 뱃지 표시만 (자동 매칭 없음)

### 사용자 흐름

**1. 타임라인 뷰**
- 주간 캘린더 표시 (오늘 ~ 다음주 일요일)
- 시간대별 예약 현황 (10분 단위)
- 예약 가능: 초록색
- 예약 완료: 회색 (예약자 이름 비공개)
- 합석 가능: 파란색 + 합석 뱃지

**2. 예약 프로세스**

**시간 선택**
- 원하는 날짜 + 시간대 클릭
- 시작 시간, 종료 시간 선택 (10분 단위)
- 최소 30분, 최대 3시간

**합석 옵션**
- "합석 허용" 체크박스
- 허용 시 다른 사용자에게 파란색 표시

**예약 확정**
- 예약 정보 확인 (날짜, 시간, 방 번호)
- "예약하기" 버튼 클릭
- 예약 완료 확인 화면

**3. 내 예약 관리**

**예약 조회**
- 다가오는 예약 목록
- 과거 예약 이력

**예약 취소**
- 시작 1시간 전까지 가능
- 1시간 이내 취소 시 벌점 (1점)

**4. 알림 수신** (예시)

**시작 임박 (10분 전)**
- "[다목적실] {방번호}번, 시작 임박 - {시작시각}에 이용이 시작되니 준비해주세요."

**종료 임박 (10분 전)**
- "[다목적실] {방번호}번, 종료 임박 - 퇴실 10분 전, 정리 후 퇴실을 준비해주세요."

**관리자 취소**
- "[다목적실] {방번호}번, 예약취소 - 관리자에 의해 예약이 취소되었습니다."

**노쇼 신고 접수**
- "[다목적실] {방번호}번, 노쇼 신고 - 사용하지 않았다는 신고가 접수되었습니다."

**5. 노쇼/미등록 신고**

**노쇼 신고**
- 예약했으나 사용하지 않음
- 원클릭 신고 → 관리 큐 적재
- 신고받은 사용자에게 알림
- 관리자 확인 후 벌점 수동 부여

**미등록 사용 신고**
- 예약 없이 사용 중인 경우
- 원클릭 신고 → 관리 큐 적재
- Band 앱으로 공지 (DormMate 알림 제외)

### 관리자 기능

**강제 예약**
- 날짜 제한 없음 (유지보수, 행사 등)
- 사용자 다이얼로그 재사용 + 관리자 스위치
- 일반 예약 차단 (해당 시간대)

**신고 관리**
- 노쇼/미등록 신고 큐 조회
- 신고 확인 및 벌점 부여
- 신고 기각 (오신고)

**예약 강제 취소**
- 사유 입력 (필수)
- 해당 사용자에게 알림 발송

***

## 공통 원칙 (Phase 2)

### 알림 피로 방지
- 하루 최대 알림 수 제한 (모듈별 2건)
- Band 앱 중복 제거 (임명, 공지 제외)
- 백그라운드 알림 설정 옵션 제공

### 상벌점 연동
- 연체: 자동 벌점 (도서관 1일 1점)
- 노쇼: 수동 벌점 (다목적실 2점)
- 세탁물 방치: 수동 벌점 (세탁실 1점)
- 벌점 누적 시 이용 제한 (예: 10점 이상 1주일 정지)

### 감사 로그
- 모든 예약/대출/사용 기록 저장
- 관리자 조회 가능
- 분쟁 발생 시 증빙 자료

==끝===