# DormMate 냉장고 MVP 시연 시나리오
*용도: 이번 배포/데모에서 반드시 구현·시연할 전체 사용자 흐름과 전체 정책을 정의한 기준 문서로, 작업 전 현재 MVP 범위를 확인할 때 사용한다.*

## 1. 데모 목표
- DormMate 냉장고 모듈의 핵심 가치(라벨 자동 발급, 검사·알림 체계, 관리자 통제)를 10분 내에 전달한다.
- 실제 배포 환경에서 동작 중인 애플리케이션을 기반으로 “거주자 → 층별장 → 관리자” 흐름을 연속 시연한다.
- SSE 기반 실시간 동기화는 확장 과제로 남기고, 단독 검사 플로우 중심으로 안정성과 완성도를 강조한다.

## 2. 사전 준비
- **배포 환경**: 발표용 서버에 최신 이미지 배포, `docker-compose.prod.yml` 기준으로 백엔드·프런트·PostgreSQL·Redis 기동.
- **데모 데이터**: 
  - 3층 거주자 계정(예: `313-1`)에 포장 2건, 임박 물품 1건, 만료 물품 1건 사전 등록.
  - 층별장 계정은 `FLOOR_MANAGER` 역할 부여, 관리자 계정은 `ADMIN` 역할 확인.
- **시연 장비**: 노트북 1대(HDMI 연결), 브라우저 2개 탭 준비(거주자/관리자). 층별장 화면은 시연 중 동일 브라우저의 시크릿 창 사용.
- **비상 플랜**: 네트워크 또는 서버 장애 시 로컬 Docker Compose 환경으로 즉시 전환할 수 있도록 이미지 사전 빌드.

## 3. 시연 흐름

### 3.1 거주자 포장 등록 및 관리
1. 거주자 계정 로그인 → `내 냉장고` 진입.
2. 배정된 칸(A/B/C 중 하나) 선택 → 물품 이름·수량·유통기한 입력 → `등록` 클릭.
3. `max_bundle_count` 검증 통과 후 자동 발급된 라벨(`A123`)과 완료 토스트 확인.
4. 목록 상단에 신규 포장이 생성된 것을 보여 주고, 검색창에 포장명 입력해 즉시 필터링.
5. 임박/만료 배지 색상(노란색, 빨간색)을 예시 포장으로 강조하고, 물품 수정을 통해 배지 상태가 업데이트되는 것을 확인.
6. 물품 하나를 소프트 삭제해 동일 스티커 번호 재사용이 가능함을 설명.

### 3.2 층별장 검사 세션 (단독 흐름)
1. 층별장 계정 로그인 → `검사 관리` → 대상 칸 선택 → `검사 시작` 클릭.
2. 칸이 잠금 상태(`검사 중` 배지)로 전환되는 UI를 보여 주고, 거주자 화면에서 수정 버튼이 비활성화됐음을 확인.
3. 검사 화면에서 문제 없는 포장은 `통과`, 임박 포장은 `경고`, 만료 포장은 `폐기`로 조치 선택.
4. 미등록 물품 발견 시 `간편 등록 → 즉시 폐기` 플로우 실행, 메모 입력 후 저장.
5. `검사 제출` 시 통계 요약(경고/폐기/총 포장 수) 확인, 칸 잠금 해제.
6. “실시간 동기화는 차기 단계”라고 언급하고, 현재는 단독 검사로도 충분히 안정적으로 동작함을 강조.

### 3.3 검사 후 사용자 알림
1. 거주자 탭으로 전환 → `[냉장고] 점검 결과 알림` 도착 확인.
2. 알림 상세에서 경고/폐기 건수와 연결된 포장 링크 클릭 → 관련 포장 상세 페이지로 이동.
3. 폐기된 포장에 대해 벌점 1점이 누적됐다는 안내(벌점 내역 모달 또는 관리자 화면 스크린샷) 공유.
4. `알림 설정` 화면에서 냉장고 알림을 개별 ON/OFF 할 수 있음을 보여 사용자 통제권을 설명.

### 3.4 임박/만료 자동 알림
1. 알림 목록에서 매일 09:00 배치로 생성된 임박/만료 알림 더미 데이터를 확인.
2. 알림을 읽으면 하단 탭 배지가 사라지는 것을 보여 주고, 만료 알림은 해결 전까지 유지됨을 설명.
3. 배치 스케줄은 Spring Scheduling으로 동작하며, Redis dedupe 키로 중복 발송을 막고 있음을 슬라이드로 간단히 소개.

### 3.5 관리자 운영 통제
1. 관리자 계정 로그인 → `냉장고 현황` 대시보드에서 층별 포장/임박 통계를 확인.
2. 특정 칸의 `max_bundle_count`를 3 → 5로 조정하고 저장, 거주자 화면에서 여유 용량이 늘어난 것을 확인.
3. 이전에 검사 중인 칸이 없음을 확인한 뒤, 다른 층별장에게 역할 부여/해제를 시연.
4. 문제가 있는 칸을 `SUSPENDED`로 전환하면 거주자 화면에서 접근이 차단되는 메시지가 나온다는 것을 짧게 보여 줌.

## 4. 마무리 및 배포 안정성 강조
- Day6 스테이징 배포 → Smoke 테스트 → 데모 데이터 시딩 → Day7 프로덕션 배포까지 완료했다는 로그/지표를 마지막 슬라이드로 제시.
- 헬스체크(`/actuator/health`), 주요 API 응답 시간, 오류 로그 미발생을 확인했다는 근거 캡처를 공유.
- 실패 시 롤백 절차(이전 버전 이미지 재배포, Flyway `undo` 시나리오)를 문서화했음을 언급.
- “실제 운영 가능한 DormMate 냉장고 MVP”라는 메시지로 시연을 마무리하고, 향후 확장(실시간 SSE, 다중 검사자 동기화, 알림 정책 UI 고도화)을 예고한다.

## 5. 발표 Q&A 대비 포인트
- **왜 SSE를 후순위로 뒀는가?** 단독 검사 플로우만으로도 정책 준수와 데이터 정합성이 보장되며, 실시간 협업은 확장 시 보안/성능 고려가 필요해 차기 과제로 남겼음을 설명.
- **알림 과다 문제 대응은?** dedupe 키, TTL, 사용자별 알림 설정으로 피로도를 관리한다는 정책(`docs/feature-inventory.md`)을 근거로 제시.
- **배포 안정성?** Docker Compose 기반 무중단 롤아웃과 Flyway 마이그레이션 검증, 모니터링/로그 체계를 보여 주어 신뢰 확보.


## 시간남으면 할것(배포후 할것)
- 검사 자동저장, 수동저장 로컬에 저장도입
- 그래도 시간이 남으면 서버에 draft로 저장 도입
